<mvc:View
    controllerName="intern.portal.controller.ChatHistory"
    xmlns:mvc="sap.ui.core.mvc"
    displayBlock="true"
    xmlns="sap.m">
    <Page id="chatPage" title="{i18n>chatTitle}" showNavButton="true" navButtonPress="onNavBack">
        <content>
            <VBox class="sapUiMediumMargin">
                <Title text="{i18n>chatTitle}" level="H1" class="sapUiMediumMarginBottom"/>
                <Text text="{i18n>chatSubtitle}" class="sapUiSmallMarginBottom"/>
                
                <!-- Chat Messages Area -->
                <Panel class="sapUiLargeMarginTop" height="400px">
                    <content>
                        <ScrollContainer id="chatContainer" 
                                       height="100%" 
                                       vertical="true"
                                       class="sapUiSmallMargin">
                            <List id="chatList" 
                                  items="{/ChatHistory}"
                                  showNoData="true"
                                  noDataText="{i18n>noMessagesText}">
                                <CustomListItem>
                                    <content>
                                        <VBox class="sapUiSmallMargin">
                                            <!-- User Message -->
                                            <HBox justifyContent="End" class="sapUiSmallMarginBottom">
                                                <Panel class="sapUiSmallMargin" 
                                                       backgroundDesign="Solid"
                                                       width="70%">
                                                    <content>
                                                        <VBox class="sapUiSmallMargin">
                                                            <Text text="You" class="sapUiTinyMarginBottom"/>
                                                            <Text text="{userMessage}"/>
                                                            <Text text="{timestamp}" class="sapUiTinyMarginTop"/>
                                                        </VBox>
                                                    </content>
                                                </Panel>
                                            </HBox>
                                            
                                            <!-- Bot Response -->
                                            <HBox justifyContent="Start" class="sapUiSmallMarginBottom">
                                                <Panel class="sapUiSmallMargin" 
                                                       backgroundDesign="Translucent"
                                                       width="70%">
                                                    <content>
                                                        <VBox class="sapUiSmallMargin">
                                                            <Text text="Assistant" class="sapUiTinyMarginBottom"/>
                                                            <FormattedText htmlText="{botReply}"/>
                                                        </VBox>
                                                    </content>
                                                </Panel>
                                            </HBox>
                                        </VBox>
                                    </content>
                                </CustomListItem>
                            </List>
                        </ScrollContainer>
                    </content>
                </Panel>
                
                <!-- Message Input Area -->
                <HBox class="sapUiMediumMarginTop" alignItems="End">
                    <Input id="messageInput" 
                           value="{/newMessage}"
                           placeholder="{i18n>messageInputPlaceholder}"
                           width="100%"
                           submit="onSendMessage"
                           class="sapUiSmallMarginEnd"/>
                    <Button id="sendButton" 
                            text="{i18n>sendButton}" 
                            type="Emphasized" 
                            press="onSendMessage"/>
                </HBox>
            </VBox>
        </content>
    </Page>
</mvc:View>
